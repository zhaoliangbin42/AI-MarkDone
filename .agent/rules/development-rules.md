---
trigger: always_on
---

# AI Agent å¼€å‘è§„èŒƒ (Universal Rules)

> **å¼ºåˆ¶çº¦æŸ**: æœ¬æ–‡æ¡£å®šä¹‰äº† AI Agent åœ¨æ‰§è¡Œä»»ä½•å¼€å‘ä»»åŠ¡æ—¶å¿…é¡»éµå¾ªçš„è§„èŒƒã€‚
> **é€‚ç”¨èŒƒå›´**: æ‰€æœ‰ä»£ç å˜æ›´ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºåŠŸèƒ½å¼€å‘ã€Bug ä¿®å¤ã€é‡æ„ã€æ ·å¼ä¿®æ”¹ã€‚
> **ç‰ˆæœ¬**: 2.0.0

---

## ğŸ“Œ é¡¹ç›®å…ˆéªŒä¿¡æ¯

### é¡¹ç›®æ¦‚è¿°

| å±æ€§ | å€¼ |
|------|-----|
| **é¡¹ç›®åç§°** | AI-MarkDone |
| **ç±»å‹** | Chrome æµè§ˆå™¨æ‰©å±• (Manifest V3) |
| **ç›®æ ‡å¹³å°** | ChatGPT, Gemini |
| **æŠ€æœ¯æ ˆ** | TypeScript, Vite, Shadow DOM |
| **ç‰ˆæœ¬** | 2.0.0 |

### æ ¸å¿ƒåŠŸèƒ½

1. **å…¬å¼å¤åˆ¶** - ä¸€é”®å¤åˆ¶ LaTeX å…¬å¼ï¼Œæ”¯æŒæµå¼è¾“å‡º
2. **Markdown å¤åˆ¶** - æ ¼å¼åŒ–å¤åˆ¶å¯¹è¯å†…å®¹
3. **å®æ—¶é¢„è§ˆ** - Markdown é‡æ–°æ¸²æŸ“æŸ¥çœ‹
4. **å­—æ•°ç»Ÿè®¡** - ç²¾ç¡® CJK å¤„ç†
5. **ä¹¦ç­¾ç®¡ç†** - æ”¶è— AI å›å¤å¹¶åˆ†ç±»ç»„ç»‡

### æ¶æ„ç‰¹ç‚¹

- **Shadow DOM éš”ç¦»** - UI ä¸å®¿ä¸»é¡µé¢æ ·å¼å®Œå…¨éš”ç¦»
- **Design Token ç³»ç»Ÿ** - ç»Ÿä¸€çš„ `--aimd-*` è¯­ä¹‰ Token
- **å¤šå¹³å°é€‚é…** - ChatGPT/Gemini ç»Ÿä¸€è§£æå™¨æ¥å£

---

## ğŸ“‹ ç›®å½•

1. [æ ¸å¿ƒåŸåˆ™](#1-æ ¸å¿ƒåŸåˆ™)
2. [ç¦æ­¢æ“ä½œæ¸…å•](#2-ç¦æ­¢æ“ä½œæ¸…å•)
3. [ä»£ç ä¿®æ”¹æµç¨‹](#3-ä»£ç ä¿®æ”¹æµç¨‹)
4. [æ¨¡å—åŒ–ä¸å¤ç”¨](#4-æ¨¡å—åŒ–ä¸å¤ç”¨)
5. [Chrome æ‰©å±•å¼€å‘è§„èŒƒ](#5-chrome-æ‰©å±•å¼€å‘è§„èŒƒ)
6. [æ–‡ä»¶ä¸ç›®å½•è§„èŒƒ](#6-æ–‡ä»¶ä¸ç›®å½•è§„èŒƒ)
7. [æµ‹è¯•ä¸éªŒè¯](#7-æµ‹è¯•ä¸éªŒè¯)
8. [æ ·å¼ä¸“é¡¹è§„èŒƒ](#8-æ ·å¼ä¸“é¡¹è§„èŒƒ)
9. [é”™è¯¯å¤„ç†ä¸æ—¥å¿—](#9-é”™è¯¯å¤„ç†ä¸æ—¥å¿—)
10. [æ–‡æ¡£ä¸æ³¨é‡Š](#10-æ–‡æ¡£ä¸æ³¨é‡Š)

---

## 1. æ ¸å¿ƒåŸåˆ™

### 1.1 ç»å¯¹ç¦æ­¢å‡è®¾

> **ç¬¬ä¸€åŸåˆ™**: ä¸å…è®¸åŸºäºå‡è®¾è¿›è¡Œä»»ä½•æ“ä½œã€‚

| åœºæ™¯ | é”™è¯¯åšæ³• | æ­£ç¡®åšæ³• |
|------|---------|---------|
| ä¿®æ”¹å‡½æ•° | å‡è®¾å‡½æ•°åªæœ‰ä¸€å¤„è°ƒç”¨ | `grep -rn "å‡½æ•°å" src/` æœç´¢æ‰€æœ‰è°ƒç”¨ |
| ä½¿ç”¨ Token | å‡è®¾ Token å·²å®šä¹‰ | `grep "tokenå" src/utils/design-tokens.ts` |
| ä¿®æ”¹ç»„ä»¶ | å‡è®¾æ²¡æœ‰å…¶ä»–ä¾èµ– | æ£€æŸ¥ import/export é“¾è·¯ |
| åˆ é™¤ä»£ç  | å‡è®¾ä»£ç æœªè¢«ä½¿ç”¨ | å…¨å±€æœç´¢ç¡®è®¤æ— å¼•ç”¨ |

### 1.2 æœç´¢ä¼˜å…ˆåŸåˆ™

**ä¿®æ”¹ä»»ä½•ä»£ç å‰ï¼Œå¿…é¡»å…ˆæ‰§è¡Œæœç´¢ç¡®è®¤**:

```bash
# 1. æœç´¢å‡½æ•°/å˜é‡çš„æ‰€æœ‰ä½¿ç”¨ä½ç½®
grep -rn "ç›®æ ‡åç§°" src/ --include="*.ts"

# 2. æœç´¢æ–‡ä»¶çš„å¯¼å…¥å…³ç³»
grep -rn "from.*ç›®æ ‡æ–‡ä»¶" src/ --include="*.ts"

# 3. æœç´¢é€‰æ‹©å™¨/Token çš„æ‰€æœ‰ä½¿ç”¨
grep -rn "ç›®æ ‡é€‰æ‹©å™¨" src/ --include="*.ts" --include="*.css"
```

### 1.3 ä¸€è‡´æ€§åŸåˆ™

| ç»´åº¦ | è§„åˆ™ |
|------|------|
| **å‘½åä¸€è‡´** | åŒç±»æ¦‚å¿µä½¿ç”¨ç›¸åŒå‘½åæ¨¡å¼ |
| **ç»“æ„ä¸€è‡´** | åŒç±»ç»„ä»¶ä½¿ç”¨ç›¸åŒç›®å½•ç»“æ„ |
| **æ¨¡å¼ä¸€è‡´** | åŒç±»é—®é¢˜ä½¿ç”¨ç›¸åŒè§£å†³æ¨¡å¼ |
| **é£æ ¼ä¸€è‡´** | éµå¾ªé¡¹ç›®ç°æœ‰ä»£ç é£æ ¼ |

### 1.4 æœ€å°å˜æ›´åŸåˆ™

```
1. åªä¿®æ”¹å¿…è¦çš„ä»£ç 
2. ä¸è¿›è¡Œ"é¡ºä¾¿"çš„ä¼˜åŒ–
3. ä¸å¼•å…¥æ— å…³çš„å˜æ›´
4. ä¿æŒ diff æœ€å°åŒ–
```

---

## 2. ç¦æ­¢æ“ä½œæ¸…å•

### 2.1 ç»å¯¹ç¦æ­¢

| # | ç¦æ­¢æ“ä½œ | åŸå›  | æ›¿ä»£æ–¹æ¡ˆ |
|---|---------|------|---------|
| 1 | `sed` æ‰¹é‡æ›¿æ¢ | ä¸å¯æ§ã€æ˜“å‡ºé”™ | ä½¿ç”¨ `replace_file_content` |
| 2 | `git checkout` å›æ»š | ç”¨æˆ·æ˜ç¡®ç¦æ­¢ | æ‰‹åŠ¨æ¢å¤æˆ–æäº¤ä¿®å¤ |
| 3 | å…¨å±€ `AllowMultiple: true` | æ‰¹é‡æ›¿æ¢é£é™© | é€ä¸ªç²¾ç¡®æ›¿æ¢ |
| 4 | æ·»åŠ  `!important` | ç ´å CSS å±‚å  | è°ƒæ•´é€‰æ‹©å™¨ä¼˜å…ˆçº§ |
| 5 | æœªéªŒè¯å°±æŠ¥å‘Šå®Œæˆ | å¯èƒ½æœ‰è¯­æ³•é”™è¯¯ | å¿…é¡» `npm run build` |
| 6 | å‡è®¾æ–‡ä»¶/å‡½æ•°å­˜åœ¨ | å¯èƒ½å·²åˆ é™¤/é‡å‘½å | å…ˆæœç´¢ç¡®è®¤ |
| 7 | åˆ é™¤"çœ‹èµ·æ¥æ²¡ç”¨"çš„ä»£ç  | å¯èƒ½æœ‰éšå¼ä¾èµ– | æœç´¢ç¡®è®¤æ— å¼•ç”¨ |

### 2.2 éœ€è¦å®¡æ‰¹çš„æ“ä½œ

ä»¥ä¸‹æ“ä½œå¿…é¡»å…ˆåˆ›å»º `implementation_plan.md` å¹¶è·å¾—ç”¨æˆ·å®¡æ‰¹ï¼š

- ä¿®æ”¹å…¬å…±æ¨¡å— (`src/utils/*`)
- ä¿®æ”¹å…±äº«ç»„ä»¶ (`src/components/*`)
- ä¿®æ”¹æ ¸å¿ƒæ¶æ„æ–‡ä»¶
- æ–°å¢/åˆ é™¤ npm ä¾èµ–
- ä¿®æ”¹æ„å»ºé…ç½® (`vite.config.ts`, `tsconfig.json`)
- ä¿®æ”¹ `manifest.json`

---

## 3. ä»£ç ä¿®æ”¹æµç¨‹

### 3.1 æ ‡å‡†ä¿®æ”¹æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 1: åˆ†æ (PLANNING)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æœç´¢ç›®æ ‡ä»£ç ä½ç½®                                          â”‚
â”‚ 2. åˆ†æä¾èµ–å…³ç³»                                              â”‚
â”‚ 3. è¯„ä¼°å½±å“èŒƒå›´                                              â”‚
â”‚ 4. åˆ¶å®šä¿®æ”¹è®¡åˆ’                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 2: æ‰§è¡Œ (EXECUTION)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æŒ‰è®¡åˆ’é€æ­¥ä¿®æ”¹                                            â”‚
â”‚ 2. æ¯ä¸ªä¿®æ”¹ç‚¹å•ç‹¬å¤„ç†                                        â”‚
â”‚ 3. ä¿æŒåŸå­æ€§ (å¯å›æ»š)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 3: éªŒè¯ (VERIFICATION)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. npm run build                                            â”‚
â”‚ 2. è¿è¡Œç›¸å…³æµ‹è¯•                                              â”‚
â”‚ 3. åŒæ­¥ Mock æ–‡ä»¶ (å¦‚é€‚ç”¨)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 å¤§æ–‡ä»¶å¤„ç†ç­–ç•¥

å½“æ–‡ä»¶è¶…è¿‡ 800 è¡Œæ—¶ï¼Œå¿…é¡»åˆ†æ®µå¤„ç†ï¼š

```bash
# Step 1: è·å–æ–‡ä»¶è¡Œæ•°
wc -l ç›®æ ‡æ–‡ä»¶.ts

# Step 2: è·å–æ–‡ä»¶å¤§çº²
# ä½¿ç”¨ view_file_outline å·¥å…·

# Step 3: åˆ†æ®µè¯»å– (æ¯æ®µ 500-800 è¡Œ)
# view_file StartLine=1 EndLine=800
# view_file StartLine=801 EndLine=1600
# ...
```

### 3.3 ä¿®æ”¹æ£€æŸ¥æ¸…å•

æ¯æ¬¡ä¿®æ”¹åå¿…é¡»ç¡®è®¤ï¼š

- [ ] `npm run build` æˆåŠŸ
- [ ] æ‰€æœ‰ç›¸å…³ä½ç½®éƒ½å·²ä¿®æ”¹
- [ ] Mock æ–‡ä»¶å·²åŒæ­¥ (å¦‚é€‚ç”¨)
- [ ] æ²¡æœ‰å¼•å…¥ç¡¬ç¼–ç å€¼
- [ ] æ²¡æœ‰ç ´åç°æœ‰åŠŸèƒ½

---

## 4. æ¨¡å—åŒ–ä¸å¤ç”¨

### 4.1 æ¨¡å—è®¾è®¡åŸåˆ™

| åŸåˆ™ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **å•ä¸€èŒè´£** | ä¸€ä¸ªæ¨¡å—åªåšä¸€ä»¶äº‹ | `BookmarkStorage` åªè´Ÿè´£å­˜å‚¨ |
| **é«˜å†…èš** | ç›¸å…³åŠŸèƒ½é›†ä¸­åœ¨ä¸€èµ· | æ‰€æœ‰ä¹¦ç­¾é€»è¾‘åœ¨ `bookmarks/` |
| **ä½è€¦åˆ** | æ¨¡å—é—´ä¾èµ–æœ€å°åŒ– | é€šè¿‡æ¥å£äº¤äº’ |
| **å¯å¤ç”¨** | é€šç”¨åŠŸèƒ½æŠ½å–ä¸ºå·¥å…· | `src/utils/` |

### 4.2 å¤ç”¨æ£€æŸ¥æµç¨‹

æ–°å¢åŠŸèƒ½å‰å¿…é¡»æ£€æŸ¥æ˜¯å¦å·²æœ‰å¯å¤ç”¨å®ç°ï¼š

```bash
# æœç´¢ç±»ä¼¼åŠŸèƒ½
grep -rn "ç›¸å…³å…³é”®è¯" src/utils/

# æœç´¢ç±»ä¼¼ç»„ä»¶
grep -rn "ç›¸å…³ç»„ä»¶å" src/components/

# æ£€æŸ¥ç°æœ‰å·¥å…·å‡½æ•°
cat src/utils/ç›®å½•ç»“æ„
```

### 4.3 ä»£ç å¤ç”¨å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: ä¸šåŠ¡ç»„ä»¶                       â”‚  src/bookmarks/, src/content/
â”‚  (ç‰¹å®šåŠŸèƒ½ï¼Œä¸å…±äº«)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 2: å…±äº«ç»„ä»¶                       â”‚  src/components/
â”‚  (å¤šå¤„ä½¿ç”¨çš„ UI ç»„ä»¶)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 3: å·¥å…·å‡½æ•°                       â”‚  src/utils/
â”‚  (çº¯å‡½æ•°ï¼Œæ— å‰¯ä½œç”¨)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Layer 4: ç±»å‹å®šä¹‰                       â”‚  src/types/
â”‚  (æ¥å£ã€ç±»å‹ã€æšä¸¾)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Chrome æ‰©å±•å¼€å‘è§„èŒƒ

### 5.1 Manifest V3 è§„åˆ™

æœ¬é¡¹ç›®ä½¿ç”¨ **Manifest V3**ï¼Œå¿…é¡»éµå®ˆï¼š

| è§„åˆ™ | è¯´æ˜ |
|------|------|
| **Service Worker** | åå°è„šæœ¬ä½¿ç”¨ Service Workerï¼ŒéæŒä¹… |
| **æƒé™æœ€å°åŒ–** | åªç”³è¯·å¿…è¦çš„æƒé™ |
| **Host Permissions** | æ˜ç¡®åˆ—å‡ºç›®æ ‡ç½‘ç«™ |
| **CSP** | ä¸å…è®¸ evalã€inline scripts |

### 5.2 Content Script è§„åˆ™

```typescript
// âœ… æ­£ç¡®: ä½¿ç”¨ Shadow DOM éš”ç¦»æ ·å¼
const shadowRoot = element.attachShadow({ mode: 'open' });

// âŒ é”™è¯¯: ç›´æ¥æ³¨å…¥å…¨å±€æ ·å¼
document.head.appendChild(styleElement);

// âœ… æ­£ç¡®: æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨
if (document.querySelector('.target')) { ... }

// âŒ é”™è¯¯: å‡è®¾å…ƒç´ å­˜åœ¨
document.querySelector('.target').click();
```

### 5.3 å­˜å‚¨è§„åˆ™

```typescript
// âœ… æ­£ç¡®: ä½¿ç”¨ chrome.storage API
chrome.storage.local.get(['key'], (result) => { ... });

// âŒ é”™è¯¯: ä½¿ç”¨ localStorage (content script ä¸­æ˜¯å®¿ä¸»é¡µé¢çš„å­˜å‚¨)
localStorage.getItem('key');
```

---

## 6. æ–‡ä»¶ä¸ç›®å½•è§„èŒƒ

### 6.1 ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ assets/           # é™æ€èµ„æº (icons.ts å”¯ä¸€å›¾æ ‡å­˜å‚¨)
â”œâ”€â”€ background/       # Service Worker
â”œâ”€â”€ bookmarks/        # ä¹¦ç­¾åŠŸèƒ½æ¨¡å—
â”œâ”€â”€ components/       # å…±äº« UI ç»„ä»¶
â”œâ”€â”€ content/          # Content Script å…¥å£
â”œâ”€â”€ parser/           # Markdown è§£æå™¨
â”œâ”€â”€ renderer/         # æ¸²æŸ“å™¨
â”œâ”€â”€ styles/           # æ ·å¼ä¸ Token
â”‚   â””â”€â”€ tokens/       # CSS Token å®šä¹‰
â”œâ”€â”€ types/            # TypeScript ç±»å‹
â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
    â””â”€â”€ design-tokens.ts  # Token å®šä¹‰
```

### 6.2 æ–‡ä»¶å‘½åè§„èŒƒ

| ç±»å‹ | è§„èŒƒ | ç¤ºä¾‹ |
|------|------|------|
| ç»„ä»¶ | PascalCase | `BookmarkPanel.ts` |
| å·¥å…· | kebab-case | `path-utils.ts` |
| ç±»å‹ | PascalCase | `BookmarkTypes.ts` |
| æµ‹è¯• | *.test.ts | `parser.test.ts` |
| æ ·å¼ | *.css.ts | `toolbar.css.ts` |

---

## 7. æµ‹è¯•ä¸éªŒè¯

### 7.1 å¿…é¡»æ‰§è¡Œçš„éªŒè¯

| åœºæ™¯ | éªŒè¯å‘½ä»¤ |
|------|---------|
| ä»»ä½•ä»£ç ä¿®æ”¹ | `npm run build` |
| ä¿®æ”¹æµ‹è¯•æ–‡ä»¶ | `npm run test` |
| ä¿®æ”¹æ ·å¼ | æ£€æŸ¥ Mock æ–‡ä»¶ |

### 7.2 Mock æ–‡ä»¶è§„èŒƒ

Mock æ–‡ä»¶ä½ç½®: `mocks/`

ç”¨é€”:
- è°ƒè¯•ç»„ä»¶æ ·å¼
- éªŒè¯æš—è‰²/äº®è‰²æ¨¡å¼
- æµ‹è¯•ä¸åŒçŠ¶æ€

åŒæ­¥è§„åˆ™:
- æºç ä¿®æ”¹åï¼Œæœç´¢ Mock ä¸­æ˜¯å¦æœ‰å¯¹åº”ä»£ç 
- æœ‰åˆ™åŒæ­¥æ›´æ–°

---

## 8. æ ·å¼ä¸“é¡¹è§„èŒƒ

> **è¯¦ç»†è§„èŒƒè§**: `docs/antigravity/style/` ç›®å½•

### 8.1 å¿«é€Ÿå¼•ç”¨

| æ–‡æ¡£ | è·¯å¾„ | ç”¨é€” |
|------|------|------|
| Workflow | `.agent/workflows/style-modification.md` | æ ·å¼ä¿®æ”¹æµç¨‹ |
| Token | `docs/antigravity/style/TOKEN_REFERENCE.md` | Token è§„èŒƒ |
| å›¾æ ‡ | `docs/antigravity/style/ICON_GUIDELINES.md` | å›¾æ ‡ä½¿ç”¨è§„èŒƒ |
| æ‰«æ | `docs/antigravity/style/SCAN_RULES.md` | æ‰«æè§„åˆ™ |
| ç»éªŒ | `docs/antigravity/style/LESSONS_LEARNED.md` | è¸©å‘ç»éªŒ |

### 8.2 æ ¸å¿ƒè§„åˆ™æ‘˜è¦

```
1. åªä½¿ç”¨è¯­ä¹‰å±‚ Token (--aimd-*)
2. ç¦æ­¢ç¡¬ç¼–ç é¢œè‰²/å°ºå¯¸
3. ç¦æ­¢ä½¿ç”¨ !important
4. ä¿®æ”¹å‰å¿…é¡»å…¨å±€æœç´¢
5. ä¿®æ”¹åå¿…é¡»åŒæ­¥ Mock
```

---

## 9. é”™è¯¯å¤„ç†ä¸æ—¥å¿—

### 9.1 é”™è¯¯å¤„ç†è§„èŒƒ

```typescript
// âœ… æ­£ç¡®: æ•è·å¹¶å¤„ç†é”™è¯¯
try {
  const result = await riskyOperation();
} catch (error) {
  console.error('[ModuleName] Operation failed:', error);
  // ä¼˜é›…é™çº§æˆ–æç¤ºç”¨æˆ·
}

// âŒ é”™è¯¯: å¿½ç•¥é”™è¯¯
try {
  await riskyOperation();
} catch { }
```

### 9.2 æ—¥å¿—è§„èŒƒ

```typescript
// æ—¥å¿—å‰ç¼€æ ¼å¼: [ModuleName]
console.log('[BookmarkStorage] Saving bookmark:', id);
console.warn('[Parser] Unknown element type:', type);
console.error('[Renderer] Failed to render:', error);
```

---

## 10. æ–‡æ¡£ä¸æ³¨é‡Š

### 10.1 æ³¨é‡Šå†…å®¹è§„èŒƒ

#### âœ… å…è®¸çš„æ³¨é‡Šå†…å®¹

- æè¿°ä»£ç çš„åŠŸèƒ½å’Œç›®çš„
- è§£é‡Šå¤æ‚ç®—æ³•æˆ–é€»è¾‘
- è¯´æ˜ Workaround çš„åŸå› 
- å…¬å…± API çš„ JSDoc æ–‡æ¡£

#### âŒ ç¦æ­¢çš„æ³¨é‡Šå†…å®¹

| ç¦æ­¢å†…å®¹ | åŸå›  |
|---------|------|
| `// v1.2.0 æ–°å¢` | ç‰ˆæœ¬ä¿¡æ¯åº”åœ¨ Git commit ä¸­è¿½è¸ª |
| `// ç”¨æˆ·è¦æ±‚ä¿®æ”¹ä¸º...` | ä¿®æ”¹åŸå› åº”åœ¨ commit message ä¸­ |
| `// ä¿®æ”¹äº† xxx` | æ— æ„ä¹‰çš„å˜æ›´æè¿° |
| `// by zhangsan` | ä½œè€…ä¿¡æ¯åº”åœ¨ Git ä¸­è¿½è¸ª |
| `// TODO: ä»¥åä¼˜åŒ–` | é™¤éæœ‰å…·ä½“è®¡åˆ’ï¼Œå¦åˆ™ä¸å†™ |

### 10.2 æ³¨é‡Šç¤ºä¾‹

```typescript
// âœ… æ­£ç¡®: æè¿°ä»£ç åŠŸèƒ½
/**
 * ä» DOM èŠ‚ç‚¹æå– LaTeX å…¬å¼
 * @param node - åŒ…å«å…¬å¼çš„ DOM èŠ‚ç‚¹
 * @returns æå–çš„ LaTeX å­—ç¬¦ä¸²
 */
function extractLatex(node: Element): string { ... }

// âœ… æ­£ç¡®: è§£é‡Šéç›´è§‰å®ç°
// ä½¿ç”¨ MutationObserver è€Œéè½®è¯¢ï¼Œå› ä¸º ChatGPT çš„æµå¼è¾“å‡º
// ä¼šæŒç»­ä¿®æ”¹ DOMï¼Œè½®è¯¢ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜
const observer = new MutationObserver(...);

// âŒ é”™è¯¯: æ— æ„ä¹‰çš„å˜æ›´æè¿°
// 2024-01-04: ä¿®æ”¹äº†è¿™ä¸ªå‡½æ•°

// âŒ é”™è¯¯: ç”¨æˆ·éœ€æ±‚ä¸åº”åœ¨ä»£ç ä¸­
// ç”¨æˆ·è¦æ±‚æ”¯æŒæš—è‰²æ¨¡å¼
```

### 10.3 JSDoc è§„èŒƒ

å…¬å…± API å¿…é¡»ä½¿ç”¨ JSDoc:

```typescript
/**
 * è§£æ Markdown å†…å®¹ä¸º AST
 * 
 * @param content - åŸå§‹ Markdown å­—ç¬¦ä¸²
 * @param options - è§£æé€‰é¡¹
 * @returns è§£æåçš„ AST èŠ‚ç‚¹æ•°ç»„
 * 
 * @example
 * ```typescript
 * const ast = parseMarkdown('# Hello');
 * ```
 */
export function parseMarkdown(
  content: string, 
  options?: ParseOptions
): ASTNode[] { ... }
```
